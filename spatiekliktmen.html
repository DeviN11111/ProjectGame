<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title> 
</head>

<style>
        body{
            background-color: gray;
        }
</style>

<body>
    
    <p>Elapsed time: <span id="time">0</span>s</p>
    <p>Space-bar: Start recording</p>
    <p>Key 1/2/3/4: Each key is a column and a timestamp</p>
    <p>Key R: Once finished use this key to sort the whole timestamp array into a finished level</p>
    <p id="levelCreater">Created Level:</p>
    <script>
        function timertieMen() {
            class Timer {
                constructor() {
                    this.isRunning = false;
                    this.startTime = 0;
                    this.overallTime = 0;
                }

                _getTimeElapsedSinceLastStart() {
                    if (!this.startTime) {
                        return 0;
                    }

                    return Date.now() - this.startTime;
                }

                start() {
                    if (this.isRunning) {
                        return console.error('Timer is already running');
                    }

                    this.isRunning = true;

                    this.startTime = Date.now();
                }

                stop() {
                    if (!this.isRunning) {
                        return console.error('Timer is already stopped');
                    }

                    this.isRunning = false;

                    this.overallTime = this.overallTime + this._getTimeElapsedSinceLastStart();
                }

                reset() {
                    this.overallTime = 0;

                    if (this.isRunning) {
                        this.startTime = Date.now();
                        return;
                    }

                    this.startTime = 0;
                }

                getTime() {
                    if (!this.startTime) {
                        return 0;
                    }

                    if (this.isRunning) {
                        return this.overallTime + this._getTimeElapsedSinceLastStart();
                    }

                    return this.overallTime;
                }
            }

            const timer = new Timer();
            timer.start();
            setInterval(() => {
                timeInMS = Math.round(timer.getTime() / 1);
                document.getElementById('time').innerText = timeInMS;

            }, 100)
        }

        var timeInMS;
        var firstPress = true;
        var timeStampsNofilter = [];
        var timeStampsfilter = [];
        var columnArray =[];
        var speeds = prompt("Kies je targetSpeed voor deez wave")
        document.addEventListener("keypress", function(e) {
            if (e.code == "Digit1" || e.code == "Digit2"|| e.code == "Digit3"|| e.code == "Digit4") {
                columnArray.push(e.code[5] - 1)
                document.getElementById('levelCreater').innerHTML = timeStampsNofilter
                timeStampsNofilter.push(timeInMS)
                console.log(columnArray)
                console.log(timeStampsNofilter)
            }

            if (e.code == "KeyR") {
                filterStamps();
                console.log(timeStampsfilter)
            }

            if(e.code == "Space"){
                if (firstPress == true) {
                    timertieMen();
                    firstPress = false
                }
            }
            
        
                
        })
      

        function filterStamps() {
            timeStampsfilter.push(timeStampsNofilter[0])
            for (i = 0; i < timeStampsNofilter.length - 1; i++) {
                timeStampsfilter.push(timeStampsNofilter[i + 1] - timeStampsNofilter[i])
            }
            for (i = 0; i < timeStampsfilter.length; i++) {
                var kroket = timeStampsfilter[i] / 25
                timeStampsfilter[i] = Math.round(kroket) * 25
            }
            for (i = 0; i < timeStampsfilter.length; i++) {
                if(timeStampsfilter[i] < speeds * 2 + 10){
                    timeStampsfilter[i] = speeds * 2 + 10
                }
            }
        }

    </script>
</body>

</html>